<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>GIMP Icon Browser - Sprite Maker</title>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            margin: 0;
            padding: 20px;
            background: #f5f5f5;
        }
        .header {
            background: #2d2d2d;
            color: white;
            padding: 20px;
            border-radius: 8px;
            margin-bottom: 20px;
        }
        .controls {
            background: white;
            padding: 20px;
            border-radius: 8px;
            margin-bottom: 20px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        .search-box {
            width: 100%;
            padding: 10px;
            border: 1px solid #ddd;
            border-radius: 4px;
            font-size: 16px;
            margin-bottom: 15px;
        }
        .filter-buttons {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
            margin-bottom: 15px;
        }
        .filter-btn {
            padding: 8px 16px;
            border: 1px solid #ddd;
            background: white;
            border-radius: 4px;
            cursor: pointer;
            transition: all 0.2s;
        }
        .filter-btn:hover, .filter-btn.active {
            background: #007acc;
            color: white;
            border-color: #007acc;
        }
        .icon-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(120px, 1fr));
            gap: 15px;
            margin-top: 20px;
        }
        .icon-item {
            background: white;
            border: 1px solid #ddd;
            border-radius: 8px;
            padding: 15px;
            text-align: center;
            transition: all 0.2s;
            cursor: pointer;
        }
        .icon-item:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0,0,0,0.15);
            border-color: #007acc;
        }
        .icon-item.selected {
            border-color: #28a745;
            background: #f8fff9;
        }
        .icon-item img {
            width: 32px;
            height: 32px;
            margin-bottom: 10px;
            display: block;
            margin-left: auto;
            margin-right: auto;
        }
        .icon-name {
            font-size: 11px;
            color: #666;
            word-break: break-word;
            line-height: 1.3;
        }
        .icon-path {
            font-size: 9px;
            color: #999;
            margin-top: 5px;
            font-family: monospace;
        }
        .stats {
            background: white;
            padding: 15px;
            border-radius: 8px;
            margin-bottom: 20px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        .selected-icons {
            background: white;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        .selected-icon {
            display: inline-block;
            margin: 5px;
            padding: 10px;
            border: 1px solid #ddd;
            border-radius: 4px;
            text-align: center;
        }
        .selected-icon img {
            width: 24px;
            height: 24px;
            margin-bottom: 5px;
        }
        .copy-btn {
            background: #28a745;
            color: white;
            border: none;
            padding: 8px 16px;
            border-radius: 4px;
            cursor: pointer;
            margin-top: 10px;
        }
        .copy-btn:hover {
            background: #218838;
        }
    </style>
</head>
<body>
    <div class="header">
        <h1>üé® GIMP Icon Browser</h1>
        <p>Browse and select the best GIMP icons for your Sprite Maker toolbar</p>
        <p><strong>Total Icons Available:</strong> <span id="total-count">Loading...</span></p>
    </div>

    <div class="controls">
        <input type="text" class="search-box" placeholder="Search icons by name..." id="searchBox">
        <div class="filter-buttons">
            <button class="filter-btn active" data-filter="all">All Icons</button>
            <button class="filter-btn" data-filter="svg">SVG Only</button>
            <button class="filter-btn" data-filter="png">PNG Only</button>
            <button class="filter-btn" data-filter="tool">Tool Icons</button>
            <button class="filter-btn" data-filter="utility">Utility Icons</button>
        </div>
    </div>

    <div class="stats">
        <h3>üìä Icon Statistics</h3>
        <div id="stats-content">Loading...</div>
    </div>

    <div class="selected-icons">
        <h3>‚≠ê Selected Icons (<span id="selected-count">0</span>)</h3>
        <div id="selected-icons-container"></div>
        <button class="copy-btn" onclick="copySelectedPaths()">üìã Copy Selected Paths</button>
    </div>

    <div class="icon-grid" id="iconGrid">
        <div>Loading icons...</div>
    </div>

    <script>
        let allIcons = [];
        let filteredIcons = [];
        let selectedIcons = new Set();

        // Load all icons
        async function loadIcons() {
            try {
                const response = await fetch('/icons/gimp-all/icon-list.txt');
                const text = await response.text();
                const iconPaths = text.trim().split('\n').filter(path => path);
                
                allIcons = iconPaths.map(path => {
                    const parts = path.split('/');
                    const filename = parts[parts.length - 1];
                    const category = parts[parts.length - 2];
                    const isTool = filename.includes('tool') || filename.includes('brush') || filename.includes('pencil') || filename.includes('eraser');
                    const isUtility = filename.includes('layer') || filename.includes('file') || filename.includes('edit') || filename.includes('view');
                    
                    return {
                        path: path,
                        filename: filename,
                        category: category,
                        type: filename.endsWith('.svg') ? 'svg' : 'png',
                        isTool: isTool,
                        isUtility: isUtility,
                        displayPath: path.replace('public/icons/gimp-all/', '')
                    };
                });

                filteredIcons = [...allIcons];
                updateStats();
                renderIcons();
                document.getElementById('total-count').textContent = allIcons.length;
            } catch (error) {
                console.error('Error loading icons:', error);
                document.getElementById('iconGrid').innerHTML = '<div>Error loading icons. Please check the console.</div>';
            }
        }

        function updateStats() {
            const stats = {
                total: allIcons.length,
                svg: allIcons.filter(icon => icon.type === 'svg').length,
                png: allIcons.filter(icon => icon.type === 'png').length,
                tools: allIcons.filter(icon => icon.isTool).length,
                utilities: allIcons.filter(icon => icon.isUtility).length
            };

            document.getElementById('stats-content').innerHTML = `
                <p><strong>SVG Icons:</strong> ${stats.svg} | <strong>PNG Icons:</strong> ${stats.png}</p>
                <p><strong>Tool Icons:</strong> ${stats.tools} | <strong>Utility Icons:</strong> ${stats.utilities}</p>
            `;
        }

        function renderIcons() {
            const grid = document.getElementById('iconGrid');
            grid.innerHTML = '';

            filteredIcons.forEach(icon => {
                const item = document.createElement('div');
                item.className = `icon-item ${selectedIcons.has(icon.path) ? 'selected' : ''}`;
                item.onclick = () => toggleIconSelection(icon);
                
                const img = document.createElement('img');
                img.src = icon.path;
                img.alt = icon.filename;
                img.onerror = () => {
                    img.style.display = 'none';
                    item.innerHTML += '<div style="color: #999; font-size: 12px;">Icon not found</div>';
                };

                item.innerHTML = `
                    <div class="icon-name">${icon.filename.replace(/\.(svg|png)$/, '')}</div>
                    <div class="icon-path">${icon.displayPath}</div>
                `;
                item.insertBefore(img, item.firstChild);
                
                grid.appendChild(item);
            });
        }

        function toggleIconSelection(icon) {
            if (selectedIcons.has(icon.path)) {
                selectedIcons.delete(icon.path);
            } else {
                selectedIcons.add(icon.path);
            }
            updateSelectedIcons();
            renderIcons();
        }

        function updateSelectedIcons() {
            const container = document.getElementById('selected-icons-container');
            const count = document.getElementById('selected-count');
            
            count.textContent = selectedIcons.size;
            container.innerHTML = '';

            selectedIcons.forEach(path => {
                const icon = allIcons.find(i => i.path === path);
                if (icon) {
                    const div = document.createElement('div');
                    div.className = 'selected-icon';
                    div.innerHTML = `
                        <img src="${path}" alt="${icon.filename}">
                        <div style="font-size: 10px;">${icon.filename}</div>
                    `;
                    container.appendChild(div);
                }
            });
        }

        function copySelectedPaths() {
            const paths = Array.from(selectedIcons);
            const text = paths.join('\n');
            navigator.clipboard.writeText(text).then(() => {
                alert('Selected icon paths copied to clipboard!');
            });
        }

        // Search functionality
        document.getElementById('searchBox').addEventListener('input', (e) => {
            const searchTerm = e.target.value.toLowerCase();
            filteredIcons = allIcons.filter(icon => 
                icon.filename.toLowerCase().includes(searchTerm)
            );
            renderIcons();
        });

        // Filter functionality
        document.querySelectorAll('.filter-btn').forEach(btn => {
            btn.addEventListener('click', (e) => {
                document.querySelectorAll('.filter-btn').forEach(b => b.classList.remove('active'));
                e.target.classList.add('active');
                
                const filter = e.target.dataset.filter;
                switch(filter) {
                    case 'svg':
                        filteredIcons = allIcons.filter(icon => icon.type === 'svg');
                        break;
                    case 'png':
                        filteredIcons = allIcons.filter(icon => icon.type === 'png');
                        break;
                    case 'tool':
                        filteredIcons = allIcons.filter(icon => icon.isTool);
                        break;
                    case 'utility':
                        filteredIcons = allIcons.filter(icon => icon.isUtility);
                        break;
                    default:
                        filteredIcons = [...allIcons];
                }
                renderIcons();
            });
        });

        // Load icons when page loads
        loadIcons();
    </script>
</body>
</html>
